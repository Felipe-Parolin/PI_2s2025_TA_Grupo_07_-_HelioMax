<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="../../images/icon.png" />
    <title>Contato</title>
    <link rel="stylesheet" href="../../styles/style_contato.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .error-message {
        color: #ff6b6b;
        font-size: 0.85rem;
        margin-top: 0.3rem;
        display: none;
      }
      .error-message.show {
        display: block;
      }
      .form-group input.error,
      .form-group textarea.error {
        border-color: #ff6b6b;
      }
    </style>
  </head>
  <body>
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
      <button class="mobile-menu-close" id="mobileMenuClose">√ó</button>
      <ul class="mobile-nav-links">
        <li><a href="landpage.html">In√≠cio</a></li>
        <li><a href="sobre.html">Sobre</a></li>
        <li><a href="contato.html" class="active">Contato</a></li>
        <li><a href="../PHP/login.php">Login</a></li>
      </ul>
    </div>

    <!-- Header -->
    <header class="header">
      <nav class="nav">
        <a href="landpage.html" class="logo">‚ö° HelioMax</a>
        <ul class="nav-links">
          <li><a href="landpage.html">In√≠cio</a></li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="contato.html" class="active">Contato</a></li>
        </ul>
        <div style="display: flex; align-items: center; gap: 1rem">
          <a href="../PHP/login.php" class="cta-button">Login</a>
          <button class="mobile-menu-toggle" id="mobileMenuToggle">‚ò∞</button>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
      <section class="hero-contact">
        <div class="hero-content">
          <h1>Entre em Contato</h1>
          <p>
            Tem d√∫vidas, sugest√µes ou quer saber mais sobre a HelioMax? Nossa
            equipe est√° pronta para ajudar voc√™!
          </p>
        </div>
      </section>

      <section class="contact-section">
        <div class="contact-wrapper">
          <!-- Contact Form -->
          <div class="contact-form-card">
            <div class="card-header">
              <div class="card-icon">‚úâÔ∏è</div>
              <h3>Envie sua Mensagem</h3>
            </div>
            <div class="success-message" id="successMessage">
              ‚úÖ Mensagem enviada com sucesso! Entraremos em contato em breve.
            </div>
            <form
              id="contactForm"
              action="https://formspree.io/f/xnnolwdq"
              method="POST"
              autocomplete="off"
            >
              <!-- Campo oculto para redirecionar ap√≥s envio (preenchido automaticamente) -->
              <input type="hidden" name="_next" id="redirectUrl" />

              <div class="form-group">
                <label for="name">Nome Completo *</label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  placeholder="Seu nome completo"
                  autocomplete="off"
                  required
                />
                <div class="error-message" id="nameError"></div>
              </div>
              <div class="form-group">
                <label for="email">E-mail *</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  placeholder="seu@email.com"
                  autocomplete="off"
                  required
                />
                <div class="error-message" id="emailError"></div>
              </div>
              <div class="form-group">
                <label for="phone">Telefone</label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  placeholder="(11) 99999-9999"
                  maxlength="15"
                  autocomplete="off"
                />
                <div class="error-message" id="phoneError"></div>
              </div>
              <div class="form-group">
                <label for="message">Mensagem *</label>
                <textarea
                  id="message"
                  name="message"
                  placeholder="Descreva sua d√∫vida, sugest√£o ou como podemos ajudar..."
                  autocomplete="off"
                  required
                ></textarea>
                <div class="error-message" id="messageError"></div>
              </div>
              <button type="submit" class="form-submit">
                <span>Enviar Mensagem</span>
                <span class="button-icon">‚ö°</span>
              </button>
            </form>
          </div>

          <!-- Contact Information -->
          <div class="contact-info-wrapper">
            <div class="contact-info-card">
              <div class="card-header">
                <div class="card-icon">üí¨</div>
                <h3>Outras Formas de Contato</h3>
              </div>
              <p class="info-subtitle">
                Escolha a melhor forma de falar conosco
              </p>

              <div class="contact-details">
                <div class="contact-item">
                  <div class="contact-item-icon">üìß</div>
                  <div class="contact-item-content">
                    <h4>E-mail</h4>
                    <p>admheliomax@gmail.com</p>
                    <p>Preencha o formul√°rio ao lado</p>
                    <p>e nos mande uma mensagem!</p>
                  </div>
                </div>

                <div class="contact-item">
                  <div class="contact-item-icon">üì±</div>
                  <div class="contact-item-content">
                    <h4>WhatsApp</h4>
                    <p>(19) 99999-9999</p>
                    <p class="hours">Seg a Sex, 19h √†s 22:30h</p>
                  </div>
                </div>

                <div class="contact-item">
                  <div class="contact-item-icon">üåê</div>
                  <div class="contact-item-content">
                    <h4>Redes Sociais</h4>
                    <p>@heliomax_oficial</p>
                    <p class="social-links">Instagram</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="logo" style="font-size: 1.8rem; margin-bottom: 1rem">
          ‚ö° HelioMax
        </div>
        <p>
          A solu√ß√£o completa para gerenciamento inteligente de ve√≠culos
          el√©tricos.
        </p>
        <p>&copy; 2025 HelioMax. Todos os direitos reservados.</p>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Define automaticamente a URL de redirecionamento
        const redirectUrlInput = document.getElementById("redirectUrl");
        const currentUrl = window.location.href.split("?")[0];
        redirectUrlInput.value = currentUrl + "?success=true";

        // Elementos do formul√°rio
        const contactForm = document.getElementById("contactForm");
        const nameInput = document.getElementById("name");
        const emailInput = document.getElementById("email");
        const phoneInput = document.getElementById("phone");
        const messageInput = document.getElementById("message");

        // Marca que o formul√°rio foi enviado
        if (performance.navigation.type === 0) {
          // Navega√ß√£o normal - verifica se foi redirecionado do Formspree
          const urlParams = new URLSearchParams(window.location.search);
          if (urlParams.get("success") === "true") {
            // For√ßa a limpeza do formul√°rio
            contactForm.reset();
            nameInput.value = "";
            emailInput.value = "";
            phoneInput.value = "";
            messageInput.value = "";

            // Mostra mensagem de sucesso
            const successMessage = document.getElementById("successMessage");
            successMessage.classList.add("show");

            // Marca que acabou de enviar
            sessionStorage.setItem("formJustSubmitted", "true");

            // Limpa a URL
            window.history.replaceState({}, "", window.location.pathname);

            setTimeout(() => {
              successMessage.classList.remove("show");
            }, 5000);
          }
        }

        // Detecta quando o usu√°rio volta da p√°gina do Formspree (usando bot√£o voltar)
        window.addEventListener("pageshow", function (event) {
          if (
            event.persisted ||
            sessionStorage.getItem("formJustSubmitted") === "true"
          ) {
            // Limpa o formul√°rio completamente
            contactForm.reset();
            nameInput.value = "";
            emailInput.value = "";
            phoneInput.value = "";
            messageInput.value = "";

            // Remove a marca√ß√£o
            sessionStorage.removeItem("formJustSubmitted");
          }
        });

        // Menu Mobile
        const mobileMenuToggle = document.getElementById("mobileMenuToggle");
        const mobileMenu = document.getElementById("mobileMenu");
        const mobileMenuClose = document.getElementById("mobileMenuClose");
        const mobileMenuOverlay = document.getElementById("mobileMenuOverlay");

        if (mobileMenuToggle) {
          mobileMenuToggle.addEventListener("click", () => {
            mobileMenu.classList.add("active");
            mobileMenuOverlay.classList.add("active");
          });
        }

        if (mobileMenuClose) {
          mobileMenuClose.addEventListener("click", () => {
            mobileMenu.classList.remove("active");
            mobileMenuOverlay.classList.remove("active");
          });
        }

        if (mobileMenuOverlay) {
          mobileMenuOverlay.addEventListener("click", () => {
            mobileMenu.classList.remove("active");
            mobileMenuOverlay.classList.remove("active");
          });
        }

        // Scroll Header
        window.addEventListener("scroll", () => {
          const header = document.querySelector(".header");
          if (header) {
            if (window.scrollY > 50) {
              header.style.background = "rgba(13, 13, 13, 0.98)";
              header.style.boxShadow = "0 2px 20px rgba(93, 173, 226, 0.2)";
            } else {
              header.style.background = "rgba(13, 13, 13, 0.98)";
              header.style.boxShadow = "0 2px 20px rgba(93, 173, 226, 0.1)";
            }
          }
        });

        // Lista de palavras ofensivas
        const badWords = [
          "idiota",
          "burro",
          "imbecil",
          "estupido",
          "est√∫pido",
          "otario",
          "ot√°rio",
          "fdp",
          "merda",
          "porra",
          "caralho",
          "desgra√ßa",
          "desgra√ßado",
          "cuzao",
          "cuz√£o",
          "babaca",
          "arrombado",
          "filho da puta",
          "filha da puta",
          "puta",
          "vagabundo",
          "safado",
          "cacete",
          "pentelho",
          "bosta",
        ];

        // Formata√ß√£o autom√°tica do telefone
        phoneInput.addEventListener("input", function (e) {
          let value = e.target.value.replace(/\D/g, "");

          if (value.length > 11) {
            value = value.slice(0, 11);
          }

          if (value.length > 0) {
            if (value.length <= 2) {
              value = `(${value}`;
            } else if (value.length <= 7) {
              value = `(${value.slice(0, 2)}) ${value.slice(2)}`;
            } else {
              value = `(${value.slice(0, 2)}) ${value.slice(
                2,
                7
              )}-${value.slice(7)}`;
            }
          }

          e.target.value = value;
        });

        // Valida√ß√£o do telefone
        function validatePhone(phone) {
          const cleanPhone = phone.replace(/\D/g, "");

          if (phone && cleanPhone.length > 0 && cleanPhone.length < 10) {
            return "Telefone inv√°lido. Digite um n√∫mero completo.";
          }

          if (cleanPhone.length > 0) {
            if (/^(\d)\1+$/.test(cleanPhone)) {
              return "Digite um n√∫mero de telefone v√°lido.";
            }

            const ddd = parseInt(cleanPhone.slice(0, 2));
            if (ddd < 11 || ddd > 99) {
              return "DDD inv√°lido.";
            }
          }

          return "";
        }

        // Valida√ß√£o de email
        function validateEmail(email) {
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

          if (!emailRegex.test(email)) {
            return "Digite um e-mail v√°lido.";
          }

          const suspiciousDomains = [
            "tempmail",
            "throwaway",
            "guerrillamail",
            "10minutemail",
          ];
          const domain = email.split("@")[1].toLowerCase();

          if (suspiciousDomains.some((d) => domain.includes(d))) {
            return "Por favor, use um e-mail v√°lido e permanente.";
          }

          return "";
        }

        // Valida√ß√£o de conte√∫do ofensivo
        function containsBadWords(text) {
          const lowerText = text
            .toLowerCase()
            .normalize("NFD")
            .replace(/[\u0300-\u036f]/g, "");

          return badWords.some((word) => {
            const normalizedWord = word
              .toLowerCase()
              .normalize("NFD")
              .replace(/[\u0300-\u036f]/g, "");
            return lowerText.includes(normalizedWord);
          });
        }

        // Mostra erro
        function showError(input, message) {
          const errorDiv = document.getElementById(`${input.id}Error`);
          errorDiv.textContent = message;
          errorDiv.classList.add("show");
          input.classList.add("error");
        }

        // Remove erro
        function clearError(input) {
          const errorDiv = document.getElementById(`${input.id}Error`);
          errorDiv.classList.remove("show");
          input.classList.remove("error");
        }

        // Valida√ß√£o em tempo real
        emailInput.addEventListener("blur", function () {
          const error = validateEmail(this.value);
          if (error) {
            showError(this, error);
          } else {
            clearError(this);
          }
        });

        phoneInput.addEventListener("blur", function () {
          const error = validatePhone(this.value);
          if (error) {
            showError(this, error);
          } else {
            clearError(this);
          }
        });

        // Valida√ß√£o no submit
        contactForm.addEventListener("submit", function (e) {
          e.preventDefault();
          let hasError = false;

          // Limpa erros anteriores
          clearError(nameInput);
          clearError(emailInput);
          clearError(phoneInput);
          clearError(messageInput);

          // Valida nome
          if (nameInput.value.trim().length < 3) {
            showError(nameInput, "Nome deve ter pelo menos 3 caracteres.");
            hasError = true;
          }

          // Valida email
          const emailError = validateEmail(emailInput.value);
          if (emailError) {
            showError(emailInput, emailError);
            hasError = true;
          }

          // Valida telefone (se preenchido)
          if (phoneInput.value) {
            const phoneError = validatePhone(phoneInput.value);
            if (phoneError) {
              showError(phoneInput, phoneError);
              hasError = true;
            }
          }

          // Valida mensagem
          if (messageInput.value.trim().length < 10) {
            showError(
              messageInput,
              "Mensagem deve ter pelo menos 10 caracteres."
            );
            hasError = true;
          } else if (containsBadWords(messageInput.value)) {
            showError(
              messageInput,
              "Por favor, mantenha uma linguagem respeitosa."
            );
            hasError = true;
          }

          // Se n√£o houver erros, envia o formul√°rio
          if (!hasError) {
            this.submit();
          }
        });
      });
    </script>
  </body>
</html>